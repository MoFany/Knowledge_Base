# CAS

## CAS概述

>#### 系统组件
>
>* `CAS服务器`和`CAS客户端`由 CAS 系统体系结构的两个物理组件组成。
>
>#### CAS 服务器
>
>* CAS 服务器是建立在 Spring 框架上的 Java servlet，其主要职责是验证用户身份。 并通过签发和验证票证来授予对支持 CAS 的服务（通常称为 CAS 客户端）的访问权限。 当服务器在成功登录后向用户发出票证授予票证 （TGT） 时，将创建 SSO 会话。 服务票证 （ST） 根据用户的请求，使用 TGT 作为令牌通过浏览器重定向颁发给服务。 随后，ST通过反向通道通信在CAS服务器上进行验证。 CAS 协议文档中对这些交互进行了非常详细的描述。
>
>#### CAS 客户端
>
>* 术语`CAS 客户端`在其常用中有两个不同的含义。CAS客户端是任何启用了CAS的应用程序，并且 可以通过支持的协议与服务器通信。CAS客户端也是一个软件包，可以是 与各种软件平台和应用程序集成，以便通过一些与CAS服务器进行通信 身份验证协议（例如 CAS、SAML、OAuth）。支持多种软件平台和产品的 CAS 客户端 已经开发。
>
>#### 安全传输`https`
>
>* ##### 与 CAS 服务器的所有通信都必须通过安全通道（即 `TLSv1`）进行。有两个主要 此要求的理由：
>
>  1. 身份验证过程需要传输安全凭据。
>
>  2. CAS 票证授予票证是持有者令牌。
>
>* ##### 由于泄露任一数据都会允许模拟攻击，因此保护 CAS 客户端和 CAS 服务器之间的通信通道，所以连接 从 CAS 服务器到应用程序必须使用 `HTTPS` 完成：
>
>  * 当生成的服务票证在“服务”URL 上发送回应用程序时
>  * 调用代理回调 URL 时
>
>

## CAS配置

>#### 配置管理
>
>```properties
># 必选： CAS 服务器全名，这是 CAS 部署面向公众的地址，而不是单个节点地址
>cas.server.name=https://cas.example.org:8443
>
># 必选： 服务器名称加上 CAS 上下文路径的串联。根部署可能需要清空此值
>cas.server.prefix=
>
># 必选： CAS 服务器范围
>cas.server.scope=example.org
>
># 可选：配置为运行 CAS 服务器的网络主机的名称
>cas.host.name=
>```
>
>#### 自定义CAS设置
>
>* 可用于本地部署的自定义设置的集合。这些设置应该可用于 CAS 视图和 Web流，用于更改 UI 和/或将自定义行为引入任何扩展的自定义组件，而无需引入新的属性命名空间。这被定义为映射，其中键应该是设置名称，值应该是设置值。
>
>  ```properties
>  cas.custom.properties=
>  ```
>
>
>
>
>

## SSO`单点登录`

>#### 概述
>
>* 基于同一个登录的不同服务间若有一个服务登录成功，其余服务均可自动验证并登录；如：百度旗下的产品共享百度账号的登录
>
>#### 单点登录配置
>
>```properties
># 必选： 加密密钥是一个 JWT，其长度由加密密钥大小设置定义
>cas.tgc.crypto.encryption.key=
>
># 必选： 签名密钥是一个 JWT，其长度由签名密钥大小设置定义
>cas.tgc.crypto.signing.key=
>```
>
>
>
>

## SLO`单点注销`

>#### 默认情况下单点注销处于打开状态
>
>#### 概述
>
>* 单点注销或单点注销 （SLO） 是一项功能，通过该功能可以通知 CAS 服务终止 CAS SSO 会话，预期服务终止 SSO 会话所有者的访问。虽然单点注销可以 提高安全性，它基本上是一个尽力而为的设施，实际上可能不会终止对所有服务的访问 在 SSO 会话期间使用。以下补偿控制可用于改善与 单点注销缺点：
>  * 要求对敏感服务进行强制身份验证
>  * 减少应用程序会话超时
>  * 减少 SSO 会话持续时间
>
>* SLO 可以通过两种方式发生：从 CAS 服务器（反向通道注销）和/或从浏览器（前通道注销）。 对于反向通道注销，SLO 进程依赖于具有线程池的类：必须定义其大小才能正确处理所有注销请求。 其他尚未处理的注销请求在发送之前会临时存储在队列中：其大小定义为线程池全局容量的 20%，并且可以进行调整。 这两种大小都是 CAS 系统的关键设置，其值不应超过 CAS 服务器的实际容量。`SimpleHttpClient`
>

## Rember Me`记住我`

>#### 长期身份验证
>
>* 此功能（也称为*“记住我”）*将 SSO 会话的长度扩展到超出典型小时数的时间段 这样用户就可以几天或几周而无需登录 CAS。
>
>#### 配置
>
>* 调整过期策略，以便记住我身份验证请求 通过长期超时过期策略和其他请求进行处理 通过 CAS 默认 SSO 会话过期策略进行处理。
>
>* 全局配置`appliation.yaml`
>
>  ```properties
>  # 必选： 加密密钥是一个 JWT，其长度由加密密钥大小设置定义
>  cas.tgc.crypto.encryption.key=
>  
>  # 必选： 签名密钥是一个 JWT，其长度由签名密钥大小设置定义
>  cas.tgc.crypto.signing.key=
>  ```
>

